---
title: "Take-Home Exercise 1: Visual Analytics of Factors Affecting Learning Outcomes"
format: html
editor: visual
author: "Cherilyn Susanto"
execute:
  warning: false
  message: false
---

# 1. Overview

This analysis investigates behavioural, socioeconomic, and institutional factors associated with students’ academic performance at the University of Education, Vietnam National University, Hanoi. Using visually driven survey analysis methods, the study moves beyond descriptive comparisons to evaluate ordinal trends, interaction effects, and structural relationships influencing GPA.

# 2. Getting Started

## Load Packages

```{r}
library(pacman)
pacman::p_load(tidyverse, reshape2, ggthemes, patchwork, scales)
theme_set(theme_minimal(base_size = 13))
```

## Import Data

```{r}
df <- read_csv("data.csv", show_col_types = FALSE)
```

# 3. Data Pre-processing

## Convert Variables to Ordered Factors

```{r}
df <- df %>%
  mutate(
    Year = factor(Year, levels = 1:5,
                  labels = c("First","Second","Third","Fourth","Graduated"),
                  ordered = TRUE),
    
    Gender = factor(Gender, levels = 1:2,
                    labels = c("Male","Female")),
    
    GPA = factor(GPA, levels = 1:5,
                 labels = c("Poor","Average","Fair","Good","Excellent"),
                 ordered = TRUE),
    
    GPA_score = as.numeric(GPA),
    
    Time_Studying = factor(Time_Studying, levels = 1:5,
                            labels = c("<2h","2-4h","4-6h","6-8h",">8h"),
                            ordered = TRUE),
    
    Time_SocicalMedia = factor(Time_SocicalMedia, levels = 1:5,
                                labels = c("<1h","1-2h","2-3h","3-4h",">4h"),
                                ordered = TRUE),
    
    Father_Edu = factor(Father_Edu, levels = 1:6,
                        labels = c("Primary","Secondary","High School",
                                   "College","University","Other"),
                        ordered = TRUE),
    
    Adapt_Learning_Uni = factor(Adapt_Learning_Uni, levels = 1:5, ordered = TRUE),
    Study_Methods = factor(Study_Methods, levels = 1:5, ordered = TRUE),
    SupportOf_Uni = factor(SupportOf_Uni, levels = 1:5, ordered = TRUE),
    SupportOf_Lec = factor(SupportOf_Lec, levels = 1:5, ordered = TRUE),
    Facilitie_Uni = factor(Facilitie_Uni, levels = 1:5, ordered = TRUE),
    Quality_Lecturer = factor(Quality_Lecturer, levels = 1:5, ordered = TRUE),
    TrainingCurriculum = factor(TrainingCurriculum, levels = 1:5, ordered = TRUE)
  )

```

## Construct Institutional Support Index

```{r}
df <- df %>%
  mutate(
    Institutional_Index =
      rowMeans(select(., Adapt_Learning_Uni,
                         Study_Methods,
                         SupportOf_Uni,
                         SupportOf_Lec,
                         Facilitie_Uni,
                         Quality_Lecturer,
                         TrainingCurriculum) %>%
                 mutate(across(everything(), as.numeric)),
               na.rm = TRUE)
  )

```

All coded survey responses were transformed into ordered factors to preserve ordinal meaning. GPA was additionally converted into a numeric score to enable mean-based trend analysis. A composite Institutional Support Index was constructed using row-wise means of seven institutional and academic support variables, producing a continuous measure ranging from 1 to 5.

# 4. Analytical Visualisations

## 4.1 Distribution of Academic Performance

```{r}
ggplot(df, aes(GPA)) +
  geom_bar(fill = "#2C3E50") +
  labs(
    title = "Overall Distribution of GPA Categories",
    x = "GPA Category",
    y = "Number of Students"
  ) +
  theme_minimal(base_size = 12) +
  theme(plot.title = element_text(face = "bold"))

```

The GPA distribution is concentrated in the “Fair” and “Good” categories, indicating generally moderate to strong academic outcomes. Very few students fall into the “Poor" and “Excellent” category remains comparatively selective. The distribution suggests academic performance is not heavily polarized but clustered around mid-to-high achievement levels.

## 4.2 Study Time and GPA

```{r}
df %>%
  group_by(Time_Studying) %>%
  summarise(mean_gpa = mean(GPA_score, na.rm = TRUE)) %>%
  ggplot(aes(Time_Studying, mean_gpa, group = 1)) +
  geom_point(size = 3) +
  geom_line() +
  labs(
    title = "Mean GPA by Daily Study Time",
    x = "Daily Study Time",
    y = "Mean GPA Score"
  ) +
  theme_minimal(base_size = 12) +
  theme(plot.title = element_text(face = "bold"))
```

Study time shows an interesting pattern. While GPA generally increases with more daily study hours, students who study 2 to 4 hours have the lowest mean GPA, even lower than those who study less than 2 hours. This unexpected dip breaks the overall positive trend between study time and academic performance.

## 4.3 Social Media Usage and Academic Performance

```{r}
df %>%
  group_by(Time_SocicalMedia) %>%
  summarise(mean_gpa = mean(GPA_score, na.rm = TRUE)) %>%
  ggplot(aes(Time_SocicalMedia, mean_gpa, group = 1)) +
  geom_point(size = 3) +
  geom_line() +
  labs(
    title = "Mean GPA by Daily Social Media Usage",
    x = "Daily Social Media Time",
    y = "Mean GPA Score"
  ) +
  theme_minimal(base_size = 12) +
  theme(plot.title = element_text(face = "bold"))

```

As social media use increases, average GPA decreases. Students who spend more than four hours a day on social media have the lowest GPAs. This may be because too much time online reduces study time or affects concentration. Although this does not prove that social media directly causes lower grades, the steady downward trend suggests that maintaining a balance is important for academic performance.

## 4.4 Parental Education Gradient

```{r}
df %>%
  group_by(Father_Edu) %>%
  summarise(mean_gpa = mean(GPA_score, na.rm = TRUE)) %>%
  ggplot(aes(reorder(Father_Edu, mean_gpa), mean_gpa)) +
  geom_col(fill = "#34495E") +
  coord_flip() +
  labs(
    title = "Mean GPA by Father's Education Level",
    x = "Father's Education",
    y = "Mean GPA Score"
  ) +
  theme_minimal(base_size = 12) +
  theme(plot.title = element_text(face = "bold"))

```

Mean GPA increases slightly as fathers’ education levels rise. Although the difference is small, a gradual upward trend is still visible, with students from higher paternal education backgrounds performing marginally better. This may reflect variations in home support, expectations, or access to learning resources.

## 4.5 Study Methods and GPA

```{r}
ggplot(df, aes(x = Study_Methods, fill = GPA)) +
  geom_bar(position = "fill") +
  labs(
    title = "Effect of Study Methods on GPA",
    x = "Effectiveness of Study Methods",
    y = "Proportion",
    fill = "GPA Level"
  ) +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal()

```

Students who perceive their study methods as “Quite” or “Very” effective show significantly higher proportions of “Good” and “Excellent” GPA outcomes. Those indicating ineffective study methods display comparatively weaker performance distributions. This suggests that not only the amount of study time but also the quality of study strategies plays a crucial role in academic outcomes. The pattern highlights the importance of effective learning techniques, time management, and self-regulated learning behaviours.

## 4.6 Institutional Support Index and GPA

```{r}
ggplot(df, aes(x = Institutional_Index, y = GPA_score)) +
  geom_jitter(alpha = 0.3) +
  geom_smooth(method = "lm", se = TRUE) +
  labs(
    title = "Institutional Support Index and GPA",
    x = "Institutional Support Index (1–5)",
    y = "GPA Score"
  ) +
  theme_minimal(base_size = 12) +
  theme(plot.title = element_text(face = "bold"))

```

A positive slope suggests institutional environment complements individual effort.

A positive linear association emerges between institutional support and GPA. Students reporting stronger institutional and academic support demonstrate higher academic performance. The regression smooth indicates a consistent upward relationship, suggesting that adaptation, lecturer support, curriculum suitability, and study methods collectively contribute to improved outcomes. This composite analysis strengthens inference beyond single-variable comparisons.

## 4.7 Correlation Structure of Academic Determinants

```{r}
cor_data <- df %>%
  select(GPA_score,
         Institutional_Index,
         Time_Studying,
         Time_SocicalMedia) %>%
  mutate(across(everything(), as.numeric)) %>%
  cor(use = "complete.obs") %>%
  as.data.frame() %>%
  rownames_to_column("Var1") %>%
  pivot_longer(-Var1, names_to = "Var2", values_to = "Correlation")

ggplot(cor_data, aes(Var1, Var2, fill = Correlation)) +
  geom_tile() +
  scale_fill_gradient2(low = "blue", high = "red", mid = "white", midpoint = 0) +
  coord_equal() +
  labs(
    title = "Correlation Matrix of Key Determinants",
    fill = "Correlation"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )
```

The correlation matrix confirms that study time and institutional support are positively associated with GPA, while social media usage exhibits a negative correlation. Institutional support also correlates positively with study behaviour, suggesting interrelated mechanisms. The matrix provides a structural overview of relationships and validates patterns observed in earlier visuals.

## 4.8 Interaction Between Study Time and Father's Education

```{r}
df %>%
  group_by(Father_Edu, Time_Studying) %>%
  summarise(mean_gpa = mean(GPA_score, na.rm = TRUE)) %>%
  ggplot(aes(Time_Studying, mean_gpa,
             colour = Father_Edu,
             group = Father_Edu)) +
  geom_line(size = 1) +   
  geom_point() +
  labs(
    title = "Interaction Between Study Time and Father's Education",
    x = "Study Time",
    y = "Mean GPA"
  )

```

## 4.9 Adaptation to University and GPA

```{r}
ggplot(df, aes(x = Adapt_Learning_Uni, fill = GPA)) +
  geom_bar(position = "fill") +
  labs(
    title = "Adaptation to University Environment and GPA",
    x = "Level of Adaptation",
    y = "Proportion"
  ) +
  theme_minimal()

```

A strong positive relationship is visible between adaptation level and GPA. Students reporting “Very” high adaptation demonstrate the largest share of “Excellent” and “Good” outcomes. In contrast, students struggling to adapt show higher proportions of lower GPA categories. This suggests that successful adjustment to the university environment may be critical for academic success. Adaptation likely influences engagement, motivation, and learning efficiency, making it an important institutional and psychological factor.

## 4.10 Academic Performance by Behavioural-Support Profiles

```{r}
df <- df %>%
  mutate(
    Study_Group = ifelse(Time_Studying %in% c("6-8h",">8h"),
                         "High Study","Low Study"),
    Support_Group = ifelse(Institutional_Index >= 4,
                           "High Support","Low Support"),
    Profile = paste(Study_Group, Support_Group, sep = " & ")
  )

```

```{r}
df %>%
  group_by(Profile) %>%
  summarise(mean_gpa = mean(GPA_score, na.rm = TRUE)) %>%
  ggplot(aes(reorder(Profile, mean_gpa), mean_gpa)) +
  geom_col(fill = "#1F618D") +
  coord_flip() +
  labs(title = "Academic Performance by Behavioural-Support Profiles",
       x = "Student Profile",
       y = "Mean GPA") +
  theme_minimal(base_size = 12) +
  theme(plot.title = element_text(face = "bold"))

```

# 5. Summary and Conclusion

This visual analytics study reveals that academic performance is shaped by both behavioural and structural factors.

Key findings:

-   Study time exhibits the strongest positive association with GPA.

-   Social media usage shows a modest negative relationship.

-   Parental education reveals a consistent socioeconomic gradient.

-   Institutional support enhances academic outcomes.

-   Effort partially compensates for structural disadvantage.

Academic success emerges from a multidimensional system rather than a single determinant.
